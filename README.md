[![Build Status](https://travis-ci.org/artemluchin/ya-environment.svg?branch=master)](https://travis-ci.org/artemluchin/ya-environment)
[![bitHound Overall Score](https://www.bithound.io/github/artemluchin/ya-environment/badges/score.svg)](https://www.bithound.io/github/artemluchin/ya-environment)

# Настройка инфраструктуры приложения

## Heroku logs

Было необходимо проанализировать логи, которые пишет heroku. Я сделал выборку
логов с боевого сервера, на котором было развернут мой проект.

[Ссылка](http://pastebin.com/kbYJNXby) на логи.

Как видно из выборки, в логах содержится довольно подробная информация о том, что
происходит с сервером. Можно узнать когда была залита последняя сборка, ее версию.
Узнать кто заливал, как прошла установка.

Помимо этого в логах содержится подробная информация о запросах. Указан тип запроса,
его URI, ip источника запроса, код ответа, имя сервера, обработавшего запрос, время обработки,
количество переданных данных.

С помощью параметров команды `heroku logs` можно формировать необходимый набор логов, который
будет отражать только нужные сообщения.

Можно заметить, что логи иногда выводятся не в том порядке, как должны были. На это у
команды heroku есть [ответ](https://devcenter.heroku.com/articles/logging#log-message-ordering).

Также видно, что `heroku` пишет не только свои системные логи, а также сообщения
из консоли. Это позволяет упростить отлов багов, при их возникновении.

Например, я делаю запрос на удаление какой либо информации `DELETE /tasks/2`. Этой
командой я хочу удалить задачу, id которой равен 2. На сервере настроена маршрутизация,
и получив такой запрос, сервер начинает выполнять какую-то функцию, отвечающую
за удаление конкретной задачи.

Какие сложности могут возникнуть? Я нажал кнопку "Удалить", но задача не удаляется.
Это может произойти по нескольким причинам. Например:

- сервер недоступен
- неверный запрос на сервер
- ошибка на самом сервере во время выполнения функции

Непонятно за что хвататься. Для этого нужно поставить обработчики ошибок на каждый
этап отправки и выполнения запроса, а также выводить сообщения об ошибках в консоль.
Тогда станет проще искать место возникновения бага. Увидив в логах сообщения о том,
что запрос успешно обработан, можно не тратить время на изучение функции отправки запроса,
а сразу переходить к функции на сервере. Проблема скорее всего там.

Таким образом, используя логи в нужных критических местах, можно существенно
снизить время на обнаружение места возникновения багов.

## Uptime Robot

<img src="https://github.com/artemluchin/ya-environment/blob/master/screenshots/Uptime%20Robot.png"/>

Uptime Robot позволяет мониторить доступность сайта. Если запрос вернется не с кодом 200,
то сервис отправит уведомление владельцам о неработающем проекте.

Какую еще информацию можно выудить из Uptime Robot? Там есть график, который отражает
время ответа сервера при запросе робота. По этому графику можно судить о загруженности
сервера в определенные моменты времени.